



<div class="top-shelf group">
  <div class="business-header group">
    <%= render "businesses/business_info", business: @business %>
    <div class="business-interact">
      <%= button_to "Write a Review", business_writeareview_url(@business.id), method: :get %>

      <%= button_to "Add Photo", business_add_photo_url(@business.id), method: :get %>
      <button class="add-button share-button">Share</button>
      <button class="add-button bookmark-button">Bookmark</button>
    </div>
  </div>

  <div class"mosaic">
    <%= render "widgets/half_map", business: @business %>

    <ul class="m group">
      <% @business.main_photos.each_with_index do |photo,i| %>
      <li>
        <%= render "photos/with_lower3",  icon_url: business_photos_url(@business.id, photo_id: photo.id),
                                          width: i==1 ? 250 : 220,
                                          photo: photo
                                        %>
      </li>
      <% end %>
    </ul>
  </div>

  <a class="more-photos" href="<%= business_photos_url(@business.id) %>">See all <%= @business.photos.length %> photos</a>
</div>


<section class="content-left">
  <section class="review-highlights">
    <% @business.get_highlight_reviews(3).each do |review| %>
      <%= render "reviews/highlight", review: review %>
    <% end %>
  </section>
  <a href="#">Show more review highlights</a>



  <div class="reviews-list">
    <h2>Recommended Reviews</h2>
    <label for="search_reviews">Search reviews</label>
    <input type="text" name="search_reviews" value="" id="search_reviews">
    <button>Search</button>
  </div>


  Yelp Sort

  <a href="#">Date</a>

  <a href="#">Rating</a>

  <a href="#">Elites</a>



  <% @business.reviews.each do |review| %>
    <%= render "reviews/medium", review: review %>
  <% end %>

</section>

<section class="right-sidebar group">

  CONTENT
</section>

<section class="best-yelp-category group">
  <h3><strong>Best of Yelp</strong></h3>
  <ul class="photos-container group">

    <% Business.best(@business.categories).each do |rest| %>
    <li><%= render "businesses/store_front_photo", business: rest %></li>
    <% end %>
  </ul>
  <a href="#">See More</a>
</section>


<script>

//display_name = (votes[vote.id] ? "#{vote.name} ( #{votes[vote.id]} )" : vote.name )

  $(document).ready( function(event) {
    //<%#= button_to display_name , review_vote_url(voted_id), method: "delete", class: "button-voted left" %>

    //<%#= button_to display_name , review_votes_url(vote: {review_id: review.id, vote_id: vote.id}), method: "post", class: "button-vote left" %>

    //review_votes_url(vote: {review_id: review.id, vote_id: vote.id})

    $(".review-vote").on("ajax:success", function(event, data) {
        $button = $(event.currentTarget).find(".vote_"+data["id"])
        $button.text(data.name);

        $button.toggleClass("voted")
    });
  });
</script